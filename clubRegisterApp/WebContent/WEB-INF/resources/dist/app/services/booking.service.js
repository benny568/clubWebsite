System.register(["@angular/core","@angular/http","../services/logger.service","../services/common.service","../dao/booking"],function(e,t){"use strict";var o,n,i,s,r,a,c,l,h,p=(t&&t.id,this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,o,r):i(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r}),u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=this&&this.__param||function(e,t){return function(o,n){t(o,n,e)}};return{setters:[function(e){o=e,n=e},function(e){i=e,s=e,r=e},function(e){a=e},function(e){c=e},function(e){l=e}],execute:function(){h=function(){function e(e,t,o){this.lg$=e,this.com$=t,this._http=o,this.logdepth=3,this.loghdr="",this.serviceName="BookingService"}return e.prototype.ngOnInit=function(){},e.prototype.payPal=function(){console.log("[BookingService]-> payPal()");var e=(JSON.stringify({amount:"110",currency_code:"EUR"}),new s.Headers({"Content-Type":"application/json"}));new r.RequestOptions({headers:e});console.log("    |- Storing booking details to server.."),this.storeBookingDetails(),console.log("    |- Calling http post to PayPal..");var t="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=9RMD69P5JPRNQ";window.location.href=t},e.prototype.storeBookingDetails=function(){var e=this,t=this.com$.getHome();console.log("-- home set to: "+t);var o=new l.Booking;o.bookingid=0,o.firstname=this.firstname,o.surname=this.surname,o.email=this.email,o.phone=this.phone,o.country=void 0!=this.country?this.country:"None",o.arrivalDate=this.arrivalDate,o.departureDate=this.departureDate,o.numberOfNights=this.numberOfNights,o.numberOfPeople=this.numberOfPeople,o.parking=this.parking,o.vehicalReg=this.vehicalReg,o.totalCharge=this.totalCharge,o.deposit=this.deposit,o.tandc=1;var n=new s.Headers;n.append("Content-Type","application/json");new r.RequestOptions({headers:n});console.log("-- posting booking to server..["+t+"/booking]"),this._http.post(t+"/booking",o,{headers:n}).subscribe(function(e){return console.log("POST of booking successfull")},function(t){return e.handleError(t)},function(){return console.log(" <=== POST of booking successfull <====")})},e.prototype.sendEmailConfirmation=function(){console.log("[BookingService]-->sendEmailConfirmation()..");var e=this.com$.getHome(),t=new l.Booking;t.bookingid=0,t.firstname=this.firstname,t.surname=this.surname,t.email=this.email,t.phone=this.phone,t.country=void 0!=this.country?this.country:"None",t.arrivalDate=this.arrivalDate,t.departureDate=this.departureDate,t.numberOfNights=this.numberOfNights,t.numberOfPeople=this.numberOfPeople,t.parking=this.parking,t.vehicalReg=this.vehicalReg,t.totalCharge=this.totalCharge,t.deposit=this.deposit,t.tandc=1;var o=new s.Headers;o.append("Content-Type","application/json");new r.RequestOptions({headers:o});this._http.post(e+"/confirmbooking",t,{headers:o}).subscribe(function(e){return console.log("Confirmation email sent successfull")},function(e){return console.log("===> Error sending confirmation email: "+e)},function(){return console.log(" <=== Confirmation email sent successfull <====")})},e.prototype.handleError=function(e){console.log("===> Error posting booking to server: "+e),this.logValues()},e.prototype.logValues=function(){console.error("BOOKING ERROR: There was an error adding the following to the database: [ firstname: "+this.firstname+", surname:  "+this.surname+", email:  "+this.email+", phone:  "+this.phone+", country:  "+this.country+", arrivalDate:  "+this.arrivalDate+", departureDate:  "+this.departureDate+", numberOfNights:  "+this.numberOfNights+", numberOfPeople:  "+this.numberOfPeople+", parking:  "+this.parking+", vehicalReg:  "+this.vehicalReg+", totalCharge:  "+this.totalCharge+", deposit:  "+this.deposit+", tandc:  "+this.tandc+" ]")},e.prototype.logValuesOLD=function(){console.log("Booking Details:"),console.log("================================"),console.log("firstname: "+this.firstname),console.log("surname:  "+this.surname),console.log("email:  "+this.email),console.log("phone:  "+this.phone),console.log("country:  "+this.country),console.log("arrivalDate:  "+this.arrivalDate),console.log("departureDate:  "+this.departureDate),console.log("numberOfNights:  "+this.numberOfNights),console.log("numberOfPeople:  "+this.numberOfPeople),console.log("parking:  "+this.parking),console.log("vehicalReg:  "+this.vehicalReg),console.log("totalCharge:  "+this.totalCharge),console.log("deposit:  "+this.deposit),console.log("tandc:  "+this.tandc)},e.prototype.testIpn=function(){var e=this,t="payment_type=instant&payment_date=Wed%20Jul%2013%202016%2015%3A58%3A27%20GMT+0100%20%28IST%29&payment_status=Completed&address_status=confirmed&payer_status=verified&first_name=John&last_name=Smith&payer_email=buyer@paypalsandbox.com&payer_id=TESTBUYERID01&address_name=John%20Smith&address_country=United%20States&address_country_code=US&address_zip=95131&address_state=CA&address_city=San%20Jose&address_street=123%20any%20street&business=seller@paypalsandbox.com&receiver_email=seller@paypalsandbox.com&receiver_id=seller@paypalsandbox.com&residence_country=US&item_name1=something&item_number1=AK-1234&tax=2.02&mc_currency=USD&mc_fee=0.44&mc_gross=12.34&mc_gross_1=12.34&mc_handling=2.06&mc_handling1=1.67&mc_shipping=3.02&mc_shipping1=1.02&txn_type=cart&txn_id=883854680&notify_version=2.1&custom=xyz123&invoice=abc1234&test_ipn=1&verify_sign=AFcWxV21C7fd0v3bYYYRCpSSRl31AeEncao9juvI7Xq0nFvvcOMm00CU",o="http://localhost:8080/clubRegisterApp/ipn",n=new s.Headers;n.append("Content-Type","application/json");new r.RequestOptions({headers:n});console.log("*****--->> Sending IPN..."),this._http.post(o+"?"+t,null,{headers:n}).subscribe(function(t){return e.checkOKresp(t)},function(e){return console.log("===> Error sending IPN: "+e)},function(){return console.log(" <=== IPN sent successfull <====")})},e.prototype.checkOKresp=function(e){console.log("IPN Test: Got first response: "+e)},e=p([o.Injectable(),g(0,n.Inject(i.Http)),u("design:paramtypes",[a.LoggerService,c.CommonService,i.Http])],e)}(),e("BookingService",h)}}});