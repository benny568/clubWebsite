System.register(["@angular/core","@angular/http","../services/logger.service","../services/common.service","../dao/booking"],function(e,t){"use strict";var o,n,i,s,r,a,l,c,h,u=(t&&t.id,this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,o,r):i(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r}),p=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=this&&this.__param||function(e,t){return function(o,n){t(o,n,e)}};return{setters:[function(e){o=e,n=e},function(e){i=e,s=e,r=e},function(e){a=e},function(e){l=e},function(e){c=e}],execute:function(){h=function(){function e(e,t,o){this.lg$=e,this.com$=t,this._http=o,this.logdepth=3,this.loghdr="",this.serviceName="BookingService"}return e.prototype.ngOnInit=function(){},e.prototype.payPal=function(){console.log("[BookingService]-> payPal()");var e=(JSON.stringify({amount:"110",currency_code:"EUR"}),new s.Headers({"Content-Type":"application/json"}));new r.RequestOptions({headers:e});console.log("    |- Storing booking details to server.."),this.storeBookingDetails(),console.log("    |- Calling http post to PayPal..");var t="";t=50===this.deposit?"https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=V27T86UZWZ55C":"https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=9346WKJ6NSDHQ",window.location.href=t},e.prototype.storeBookingDetails=function(){var e=this,t=this.com$.getHome();console.log("-- home set to: "+t);var o=new c.Booking;o.bookingid=0,o.firstname=this.firstname,o.surname=this.surname,o.email=this.email,o.phone=this.phone,o.country=void 0!==this.country?this.country:"None",o.arrivalDate=this.arrivalDate,o.departureDate=this.departureDate,o.numberOfNights=this.numberOfNights,o.numberOfPeople=this.numberOfPeople,o.parking=this.parking,o.vehicalReg=this.vehicalReg,o.totalCharge=this.totalCharge,o.deposit=this.deposit,o.tandc=1;var n=new s.Headers;n.append("Content-Type","application/json");new r.RequestOptions({headers:n});console.log("-- posting booking to server..["+t+"/booking]"),this._http.post(t+"/booking",o,{headers:n}).subscribe(function(e){return console.log("POST of booking successfull")},function(t){return e.handleError(t)},function(){return console.log(" <=== POST of booking successfull <====")})},e.prototype.sendEmailConfirmation=function(){console.log("[BookingService]-->sendEmailConfirmation()..");var e=(this.com$.getHome(),new c.Booking);e.bookingid=0,e.firstname=this.firstname,e.surname=this.surname,e.email=this.email,e.phone=this.phone,e.country=void 0!==this.country?this.country:"None",e.arrivalDate=this.arrivalDate,e.departureDate=this.departureDate,e.numberOfNights=this.numberOfNights,e.numberOfPeople=this.numberOfPeople,e.parking=this.parking,e.vehicalReg=this.vehicalReg,e.totalCharge=this.totalCharge,e.deposit=this.deposit,e.tandc=1,console.log("[BookingService]-->sendEmailConfirmation() should be sending email with following details:"),console.log("Name: "+e.firstname+" "+e.surname),console.log("email: "+e.email);var t=new s.Headers;t.append("Content-Type","application/json");new r.RequestOptions({headers:t})},e.prototype.handleError=function(e){console.log("===> Error posting booking to server: "+e),this.logValues()},e.prototype.logValues=function(){console.error("BOOKING ERROR: There was an error adding the following to the database: [ firstname: "+this.firstname+", surname:  "+this.surname+", email:  "+this.email+", phone:  "+this.phone+", country:  "+this.country+", arrivalDate:  "+this.arrivalDate+", departureDate:  "+this.departureDate+", numberOfNights:  "+this.numberOfNights+", numberOfPeople:  "+this.numberOfPeople+", parking:  "+this.parking+", vehicalReg:  "+this.vehicalReg+", totalCharge:  "+this.totalCharge+", deposit:  "+this.deposit+", tandc:  "+this.tandc+" ]")},e.prototype.logValuesOLD=function(){console.log("Booking Details:"),console.log("================================"),console.log("firstname: "+this.firstname),console.log("surname:  "+this.surname),console.log("email:  "+this.email),console.log("phone:  "+this.phone),console.log("country:  "+this.country),console.log("arrivalDate:  "+this.arrivalDate),console.log("departureDate:  "+this.departureDate),console.log("numberOfNights:  "+this.numberOfNights),console.log("numberOfPeople:  "+this.numberOfPeople),console.log("parking:  "+this.parking),console.log("vehicalReg:  "+this.vehicalReg),console.log("totalCharge:  "+this.totalCharge),console.log("deposit:  "+this.deposit),console.log("tandc:  "+this.tandc)},e.prototype.testIpn=function(){var e=this,t="charset=UTF-8&payer_email=odalybr@hotmail.com&receiver_email=treasurer@avenueunited.ie&address_country_code=IE&payer_status=verified&receiver_id=NDYSM5YGRVU2Y&address_state=Clare&item_number=&transaction_subject=&address_name=Brendan O'Daly&address_status=confirmed&residence_country=IE&txn_id=0WE14547FT718715A&protection_eligibility=Eligible&payment_gross=&verify_sign=AcE2uah9fzGQIYibH799J4hdOjH.ANduMFrh6.iW-t0JOFCS2jDIcIKy&first_name=Brendan&payment_date=06:29:55 Jul 14, 2016 PDT&quantity=1&business=treasurer@avenueunited.ie&address_country=Ireland&payment_status=Completed&custom=&last_name=O'Daly&item_name=Testing&notify_version=3.8&mc_currency=EUR&address_city=Ennis&payment_type=instant&txn_type=web_accept&address_street=Reaskaun Larchill&payment_fee=&payer_id=CJ9WTRLB4Z6D6&address_zip=&mc_gross=0.01&mc_fee=0.01&ipn_track_id=a089ad032fd6",o="http://localhost:8080/clubRegisterApp/ipn",n=new s.Headers;new r.RequestOptions({headers:n});console.log("*****--->> Sending IPN..."),this._http.post(o+"?"+t,null,{headers:n}).subscribe(function(t){return e.checkOKresp(t)},function(e){return console.log("===> Error sending IPN: "+e)},function(){return console.log(" <=== IPN sent successfull <====")})},e.prototype.checkOKresp=function(e){console.log("IPN Test: Got first response: "+e);var t="http://localhost:8080/clubRegisterApp/ipn";this._http.post(t,"VERIFIED",null).subscribe(function(e){return console.log("IPN VERIFICATION sent.")},function(e){return console.log("===> Error sending IPN VERIFICATION: "+e)},function(){return console.log(" <=== IPN verified successfull <====")})},e=u([o.Injectable(),g(0,n.Inject(i.Http)),p("design:paramtypes",[a.LoggerService,l.CommonService,i.Http])],e)}(),e("BookingService",h)}}});